<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>include</title>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <main>
        <h1>Tasks</h1>
        <div class="task-container">
            <!-- TODO - this should turn into a custom element -->
            <div class="input">
                <p>count: <span></span></p>
                <div>
                    <div>
                        <div class="input-source">
                            <label for="taskName">Name: </label>
                            <input id="taskName" type="text" data-attr="name">
                        </div>
                        <div class="input-source">
                            <label for="taskTask">Task: </label>
                            <input id="taskTask" type="text" data-attr="task">
                        </div>
                    </div>
                    <button onclick="addTask(event)">add</button>
                </div>
            </div>
            <!-- TODO - this should turn into a custom element -->
            <div class="tasks">
                <app-task name="Benny" task="Dishes"></app-task>
                <app-task name="Jenny" task="Laundry"></app-task>
                <app-task name="Kenny" task="Trash"></app-task>
                <app-task name="Lenny" task="Gardening"></app-task>
            </div>
        </div>
    </main>
    <script>
        window.__host = e => e.target.getRootNode().host
        window.__callHost = (e, f) => window.__host(e)[f](e)

        window.addTask = e => {
            const task = document.createElement('app-task')
            const parent = e.target.parentElement
            task.setAttribute('name', parent.querySelector('[data-attr="name"]').value)
            task.setAttribute('task', parent.querySelector('[data-attr="task"]').value)
            document.querySelector('.tasks').appendChild(task)
        }

        let numberOfTasks = 0
        document.body.addEventListener('app-task:added', e => {
            numberOfTasks++
            document.querySelector('.task-container p span').textContent = numberOfTasks
        })
        document.body.addEventListener('app-task:removed', e => {
            numberOfTasks--
            document.querySelector('.task-container p span').textContent = numberOfTasks
        })
    </script>
    <include src="task.html"></include>
</body>

</html>